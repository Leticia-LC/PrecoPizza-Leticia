<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Pizza</title>

    <style>
        body {
            background-color: #f0f7fa;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 50%;
            width: 400px;
            text-align: center;
        }

        h1 {
            color: #1f487e;
        }

        .form-label {
            color: #1f487e;
        }

        .btn-primary {
            background-color: #1f487e;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-primary:hover {
            background-color: #15325a;
        }

        .table {
            margin-top: 20px;
        }

        .table th, .table td {
            border: 1px solid #1f487e;
            padding: 8px;
        }

        .table-success {
            background-color: #d1e7dd;
        }

        .mb-3 {
            margin-bottom: 15px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <form id="pizzaForm">
            <h1>Preço Pizza</h1>
            <div class="mb-3">
                <label for="pizzaName" class="form-label">Nome:</label>
                <input type="text" class="form-control" id="pizzaName" placeholder="Ex: Média" required>
            </div>

            <div class="mb-3">
                <label for="pizzaShape" class="form-label">Forma da Pizza:</label>
                <select class="form-select" id="pizzaShape" onchange="toggleInputs()" required>
                    <option value="round" selected>Redonda</option>
                    <option value="square">Quadrada</option>
                    <option value="rectangular">Retangular</option>
                </select>
            </div>

            <div id="dimensionInputs" class="mb-3">
                <label id="label1" for="dimension1" class="form-label">Tamanho (cm):</label>
                <input type="number" class="form-control" id="dimension1" required>

                <label id="label2" class="hidden form-label" for="dimension2">Dimensão 2:</label>
                <input class="hidden form-control" type="number" id="dimension2">
            </div>

            <div class="mb-3">
                <label for="pizzaPrice" class="form-label">Preço:</label>
                <input type="number" class="form-control" id="pizzaPrice" required>
            </div>

            <button type="submit" id="addPizza" class="btn btn-primary">Adicionar Pizza</button>
        </form>

        <div class="table-responsive mt-4">
            <table id="pizzaTable" class="table table-bordered table-hover align-middle">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Tamanho</th>
                        <th>Preço</th>
                        <th>Preço por cm²</th>
                        <th>Diferença %</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        const form = document.querySelector('#pizzaForm');
        const shapeSelect = document.querySelector('#pizzaShape');
        const tbody = document.querySelector('#pizzaTable tbody');

        let pizzas = [];

        form.addEventListener('submit', function (event) {
            adicionarPizza(event);
        });

        function adicionarPizza(event) {
            event.preventDefault();

            const nome = document.querySelector('#pizzaName').value;
            const dimensao1 = parseFloat(document.querySelector('#dimension1').value);
            const dimensao2 = parseFloat(document.querySelector('#dimension2').value);
            const preco = parseFloat(document.querySelector('#pizzaPrice').value);

            if (!nome || isNaN(dimensao1) || isNaN(preco)) {
                alert('Por favor, preencha todos os campos obrigatórios e forneça valores válidos.');
                return;
            }

            if (shapeSelect.value === 'rectangular' && isNaN(dimensao2)) {
                alert('Por favor, forneça um valor válido para Dimensão 2.');
                return;
            }

            let tamanho, area;

            switch (shapeSelect.value) {
                case 'round':
                    const raio = dimensao1 / 2;
                    tamanho = dimensao1;
                    area = Math.PI * (raio * raio);
                    break;
                case 'square':
                    tamanho = dimensao1 * dimensao1;
                    area = tamanho;
                    break;
                case 'rectangular':
                    tamanho = dimensao1 * dimensao2;
                    area = tamanho;
                    break;
                default:
                    console.error('Forma de pizza não reconhecida');
                    return;
            }

            const pizza = {
                nome: nome,
                tamanho: tamanho,
                dimensao1: dimensao1,
                dimensao2: dimensao2,
                preco: preco,
                precoPorCm: preco / area,
                forma: shapeSelect.value,
            };

            pizzas.push(pizza);
            updateTable();
            form.reset(); // Limpa o formulário após adicionar uma pizza
        }

        function updateTable() {
            tbody.innerHTML = '';

            pizzas.sort((a, b) => a.precoPorCm - b.precoPorCm);

            let melhorCustoBeneficio = pizzas[0];

            pizzas.forEach((pizza, index) => {
                let newLine = document.createElement('tr');

                appendTableCell(newLine, pizza.nome);
                appendTableCell(newLine, formatTamanho(pizza));
                appendTableCell(newLine, formatCurrency(pizza.preco));
                appendTableCell(newLine, formatCurrency(pizza.precoPorCm));
                appendTableCell(newLine, calcularDiferencaPercentual(pizza, melhorCustoBeneficio));

                tbody.appendChild(newLine);

                if (index === 0) {
                    newLine.classList.add('table-success');
                }
            });
        }

        function appendTableCell(row, content) {
            let cell = document.createElement('td');
            cell.textContent = content;
            row.appendChild(cell);
        }

        function toggleInputs() {
            const dimensao1Label = document.querySelector('#label1');
            const dimensao2Label = document.querySelector('#label2');
            const dimensao2Input = document.querySelector('#dimension2');

            switch (shapeSelect.value) {
                case 'round':
                case 'square':
                    dimensao1Label.textContent = 'Tamanho (cm)';
                    dimensao2Label.classList.add('hidden');
                    dimensao2Input.classList.add('hidden');
                    break;
                case 'rectangular':
                    dimensao1Label.textContent = 'Lado 1 (cm)';
                    dimensao2Label.textContent = 'Lado 2 (cm):';
                    dimensao2Label.classList.remove('hidden');
                    dimensao2Input.classList.remove('hidden');
                    break;
                default:
                    console.error('Forma de pizza não reconhecida');
            }
        }

        function formatTamanho(pizza) {
            if (pizza.forma === 'rectangular') {
                return `${pizza.dimensao1}cm x ${pizza.dimensao2}cm`;
            } else if (pizza.forma === 'square') {
                return `${pizza.dimensao1}cm x ${pizza.dimensao1}cm`;
            } else {
                return `${pizza.tamanho}cm`;
            }
        }

        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        function calcularDiferencaPercentual(pizza, melhorCustoBeneficio) {
            const diferencaPercentual = ((pizza.precoPorCm - melhorCustoBeneficio.precoPorCm) / melhorCustoBeneficio.precoPorCm) * 100;

            if (diferencaPercentual > 0) {
                return `+${diferencaPercentual.toFixed(2)}%`;
            } else {
                return `${diferencaPercentual.toFixed(2)}%`;
            }
        }
    </script>
</body>
</html>
